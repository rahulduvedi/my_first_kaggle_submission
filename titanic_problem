import pandas as pd
import numpy as np
train_data = pd.read_csv(r"C:\Users\rahul\Documents\titanic\train.csv")
test_data = pd.read_csv(r"C:\Users\rahul\Documents\titanic\test.csv")
train_data = train_data.drop(['Cabin','Age','Name','Ticket'],axis=1)
test_data = test_data.drop(['Cabin','Age','Name','Ticket'],axis=1)
import numpy as np
train_data['Embarked'].isnull().sum()
#print(len(train_data['Embarked']))
train_data = train_data.replace({'Embarked':np.NaN},'S')
train_data['Embarked'].value_counts()   
#cols_with_missing = [col for col in new_train_data.columns if new_train_data[col].isnull().any()]
train_data.set_index('PassengerId')
non_numeric_cols = ['Sex','Embarked']
from sklearn.preprocessing import OneHotEncoder
OH_encoder = OneHotEncoder(handle_unknown='ignore',sparse= False)
new_train_data= pd.DataFrame(OH_encoder.fit_transform(train_data[non_numeric_cols]))
new_test_data = pd.DataFrame(OH_encoder.transform(test_data[non_numeric_cols]))
new_train_data.index = train_data.index
new_test_data.index = test_data.index
numeric_only_train_data = train_data.drop(non_numeric_cols,axis=1)
numeric_only_test_data = test_data.drop(non_numeric_cols,axis=1)
final_train = pd.concat([new_train_data,numeric_only_train_data],axis=1)
final_test = pd.concat([new_test_data,numeric_only_test_data],axis=1)
final_train
final_train.set_index("PassengerId")
cols_with_missing = [col for col in final_test.columns if
                           final_test[col].isnull().any()]
final_test_new = final_test.replace({'Fare':np.NaN},7.7500)
final_test.set_index("PassengerId")
y = final_train.Survived
X = final_train.drop(['Survived'],axis=1)
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(n_estimators=150, max_depth=5, random_state=1)
model.fit(X,y)
predictions= model.predict(final_test)
